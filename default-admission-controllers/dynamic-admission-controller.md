## DYNAMIC ADMISSION CONTROL

## REF LINK : ``` https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/ ```

![image](https://github.com/pavankumar0077/istio-guide/assets/40380941/ce73ec7e-0277-4ad1-9f4a-9d129454571a)

![image](https://github.com/pavankumar0077/istio-guide/assets/40380941/d41eeadd-496e-4492-a3e2-5d722258fd9c)

- Dynamic admission control - Happens in multiple stages the same pod creation request comes to the kubernetes cluster API-SERVER WILL PERFORM AUTH & AUTHORIZATION
- BUT HERE NOT THE STANDARDED ADMISSION CONTROLLERS, THERE ARE 2 SPECIAL ADMISSION CONTROLLERS WHICH ARE CALLED AS
- 1. MUTATING ADMISSION WEB HOOK CONTROLLER
  2. VALIDATING ADMISSION WEB HOOK CONTROLLER ALONG WITH THE TRADTIONAL CONTROLLERS
- THE RESPONSIBLITY OF THE COTROLLERS ARE THE ONCES THEY WILL TAKE OUR INPUT OR THEY TAKE REQEUST FROM THE API-SERVER AND THEY NOTIFY ISTIO OR ANY OTHER PROJECT THAT WANTS TO IMPLEMENT THE SIDECAR INJECTION OR ANY KIND OF MUTATION AND VALIDATION
- SO which COMPONENT OF API SERVER IS TAKING THIS RESPONSIBILITY IT IS AGAIN AN ADMISSION CONTROLLER WHICH IS HELPING IN THE DYNAMIC ADMISSION CONTROL BUT THIS COMPONENT DOES NOT PERFORM THE MUTATION OR VALIDATION IT ONLY FORWARDS THE REQEUST TO ANY WEB HOOK THAT IS IMPLEMENTED BY THE PROJECT
- So ISTIO IS GOING TO IMPLEMENT AN ADMISSION WEB HOOK WHICH IS AGAIN A KUBERNETS CONTROLLER IT IS PART OF ISTIOD AND THIS ADMISSION WEB HOOK IS CALLED BY THE MUTATING ADMISSION WEB HOOK CONTROLLER THIS GOING TO PERFORM MUTATION LOGIC AND IT IS GOING TO INJECT THE SIDE-CAR CONTAINER AND THEN OBJECT IS PERSISTED INTO ETCD.
-
```
idrbt@idrbt:~/istio-1.22.0$ kubectl get mutatingwebhookconfiguration
NAME                         WEBHOOKS   AGE
istio-revision-tag-default   4          42h
istio-sidecar-injector       4          42h
idrbt@idrbt:~/istio-1.22.0$
```
- So, this mutatingwebhookconfiguration CUSTOM RESOURCE IS SUBMITTED TO THE API SERVER, THIS IS READ BY THIS MUTATING ADMISSION WEBHOOK CONTROLLER AND WHAT IT WILL UNDERSTAND FROM THE CUSTOM RESOURCE IS
- IT WILL LOOKS FOR RULES, WHERE RULES SAY - WHENEVER A POD IS CREATED DOESN'T MATTER IN WHICH NAMESPACE  DOESN'T MATTER JUST LET ME KNOW, BY USING THE FIELD CALLED SERVICE.
- THIS CUSTOM RESOURCE IS ACTUALLY TELLING THE MUTATION WEBHOOK CONTROLLER THAT WHENEVER A POD IS CREATED JUST FORWARD THE REQUEST TO THIS WEBHOOK CALLED ISTIOD THAT IS AVAILABLE IN THE ISTIO SYSTEM NAMESPACE
- SO MUTATING ADMISSION WEB HOOK CONTROLLER WHENEVER A POD IS CREATED BE'COZ THE CUSTOM RESOURCE IS TELLING IT TO FORWARD THE REQUEST TO ISTIO AND THE WEBHOOK IT FORWARDS THE REQUEST TO IT.
- THIS ISTIOD ADMISSION WEBHOOK TAKES THE API REQUEST AND PERFORMS THE MUTATION AND THEN IT RETURNS THE OBJECT BACK TO API SERVER - FROM THERE OBJECT GOES TO ETCD.
- THIS IS HOW DYNAMIC ADMISSION CONTROLLER WORKS.
- LET'S SAYS TOMORROW YOU WANT TO IMPLEMENT SOMETHING ELSE, WE CAN ALSO DEVELOP OUR OWN WEB HOOK, LET'S SAY PAVAN WEB HOOK, I CAN CREATE THIS PAVAN WEB HOOK BUT WHAT ALSO SHOULD I NEED DO IS I SHOULD ALSO CREATE A CUSTOM RESOURCE CALLLED
- MUTATING ADMISSION WEB HOOK CONFIGURATION OR VALIDATING WEB HOOK CONFIGURATION IN THAT CONFIGURATION I HAVE TO CLEARLY SAY THE API SERVER WHEN SHOULD IT FORWAD THE REQEUST TO MY WEB HOOK AND WHAT IS THE PATH OF MY WEBHOOK AND WHERE IT IS LOCATED, IN WHICH NAMESPACE AND ON WHICH PATH SHOULD IT SEND A API CALL TO 
